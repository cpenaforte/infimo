{"version":3,"file":"infimo.js","mappings":"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AACA;;AAEA,aAAa,cAAc;AAC3B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA4B;AAC5B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,iBAAiB;AACjB;AACA;;AAEA,oBAAoB;AACpB;AACA;;AAEA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;;;;;UCpJA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://Infimo/webpack/universalModuleDefinition","webpack://Infimo/./src/main.ts","webpack://Infimo/./src/subclasses/NameRegister.ts","webpack://Infimo/./src/subclasses/Ref.ts","webpack://Infimo/./src/subclasses/VirtualMachine.ts","webpack://Infimo/./node_modules/vm-browserify/index.js","webpack://Infimo/webpack/bootstrap","webpack://Infimo/webpack/before-startup","webpack://Infimo/webpack/startup","webpack://Infimo/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Infimo\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Infimo\"] = factory();\n\telse\n\t\troot[\"Infimo\"] = factory();\n})(self, () => {\nreturn ","import { DataProp, PropType, Listeners, InfimoObject } from \"./types\";\nimport NameRegister from \"./subclasses/NameRegister\";\nimport Ref from \"./subclasses/Ref\";\nimport VirtualMachine from \"./subclasses/VirtualMachine\";\n\nclass InfimoFactory {\n    private appId: string | undefined;\n    private template: string;\n    private listeners: Listeners;\n    private refs: Ref<any>[];\n    private namesRegister: NameRegister;\n\n    constructor(infimoObject: InfimoObject) {\n        this.template = infimoObject.template;\n        this.listeners = {};\n        this.refs = [];\n        this.namesRegister = new NameRegister();\n\n        this.data(infimoObject.data || {});\n        this.watch(infimoObject.watch || {});\n        this.methods(infimoObject.methods || {});\n    }\n\n    private notifyListeners<T>(name: string, newValue: T, oldValue: T): void {\n        if (this.listeners[name]) {\n            this.listeners[name].forEach(listener => listener(newValue, oldValue));\n        }\n\n        this.appId && this.build(this.appId);\n    }\n\n    private dataParse<T>(data: [string, T]): void {\n        const [name, value] = data;\n\n        const registeredName = this.namesRegister.registerName(name, PropType.DATA);\n\n        const dataRef = new Ref(registeredName, value);\n        this.refs.push(dataRef);\n\n        Object.defineProperties(this, {\n            [name]: {\n                get: () => dataRef.getValue(),\n                set: (newValue: T) => {\n                    const oldValue = dataRef.getValue();\n                    dataRef.updateValue(newValue);\n                    this.notifyListeners(name, newValue, oldValue);\n                }\n            }\n        });\n    }\n\n    data(dataProp: DataProp): void {\n        Object.entries(dataProp).forEach(data => this.dataParse(data));\n    }\n\n    private watchParse<T>(watch: [string, (newValue?: T, oldValue?: T) => void]): void {\n        const [name, value] = watch;\n\n        if (!this.namesRegister.nameExist(name)) {\n            throw new Error(`Name ${name} does not exist`);\n        }\n\n        if (!this.listeners[name]) {\n            this.listeners[name] = [];\n        }\n\n        this.listeners[name].push(value);\n    }\n\n    watch(watchProp: { [key: string]: (newValue?: any, oldValue?: any) => void }): void {\n        Object.entries(watchProp).forEach(watch => this.watchParse(watch));\n    }\n\n    private methodsParse(method: [string, Function]): void {\n        const [name, value] = method;\n\n        const refThis = this;\n\n        const parsedFunction = (...args: any) => value.call(refThis, ...args);\n\n        const registeredName = this.namesRegister.registerName(name, PropType.METHODS);\n\n        const methodRef = new Ref(registeredName, parsedFunction);\n        this.refs.push(methodRef);\n\n        Object.defineProperty(this, name, {\n            get: () => methodRef.getValue()\n        });\n    }\n\n    methods(methodsProp: { [key: string]: Function }): void {\n        Object.entries(methodsProp).forEach(method => this.methodsParse(method));\n    }\n\n    private parseTemplate(): string {\n        const intermediate = `${this.template}`;\n\n        const vm = new VirtualMachine();\n        vm.initThis(this);\n\n        return intermediate.replace(/{{(.*?)}}/g, (match) => {\n            const evalutated = vm.runScriptSync(match);\n\n            return `${evalutated}`;\n        }).replace(/{{/g, \"\").replace(/}}/g, \"\");\n    }\n\n    build(appId: string): void {\n        this.appId = appId;\n\n        const parsedTemplate = this.parseTemplate();\n\n        const step = document.createElement(\"div\");\n        step.innerHTML = parsedTemplate;\n        const element = step.firstElementChild;\n\n        if (element) {\n            document.querySelector(this.appId)?.appendChild(element);\n        }\n    }\n}\n\nexport default InfimoFactory;","import { PropType, RegisteredName, RegisteredNames } from \"../types\";\n\nexport default class NameRegister {\n    private names: RegisteredNames;\n\n    constructor() {\n        this.names = [];\n    }\n\n    registerName(name: string, type: PropType): RegisteredName {\n        // Check if name already exists\n        if (this.nameExist(name)) {\n            throw new Error(`Name ${name} already exists`);\n        }\n\n        const nameObj = {name, type};\n\n        this.names.push(nameObj);\n\n        return nameObj;\n    }\n\n    registerNames(names: RegisteredNames): void {\n        // Check if names already exist\n        let nameExist = names.find(n => this.nameExist(n.name))?.name;\n\n        if (nameExist) {\n            throw new Error(`Name ${nameExist} already exists`);\n        }\n\n        this.names.push(...names);\n    }\n\n    nameExist(name: string): boolean {\n        return this.names.some(n => n.name === name);\n    }\n\n    getNames(): RegisteredNames {\n        return this.names;\n    }\n}","import { RegisteredName } from \"../types\";\n\nexport default class Ref<T> {\n    private name: RegisteredName;\n    private value: T;\n\n    constructor(name: RegisteredName, value: T) {\n        this.name = name;\n        this.value = value;\n    }\n\n    updateValue(value: T): void {\n        this.value = value;\n    }\n\n    getName(): RegisteredName {\n        return this.name;\n    }\n\n    getValue(): T {\n        return this.value;\n    }\n}","import vm from \"vm\";\n\nexport default class VirtualMachine {\n    private context: { [key: string]: any };\n\n    constructor() {\n        this.context = {};\n    }\n\n    initThis(thisObj: { [key: string]: any }): void {\n        const descriptors = Object.getOwnPropertyDescriptors(thisObj);\n        const parseDescriptors = Object.entries(descriptors).map(([key, value]) => {\n            const newValue = value.get ? value.get() : value.value;\n            console.log(newValue);\n            return [key, newValue];\n        });\n\n        this.context = Object.fromEntries(parseDescriptors);\n    }\n\n    runScriptSync(script: string): any {\n        let result = null;\n\n        try {\n            result = new vm.Script(script).runInNewContext(this.context);\n        } catch (e) {\n            console.error(e);\n        } finally {\n            return result;\n        }\n    }\n}","var indexOf = function (xs, item) {\n    if (xs.indexOf) return xs.indexOf(item);\n    else for (var i = 0; i < xs.length; i++) {\n        if (xs[i] === item) return i;\n    }\n    return -1;\n};\nvar Object_keys = function (obj) {\n    if (Object.keys) return Object.keys(obj)\n    else {\n        var res = [];\n        for (var key in obj) res.push(key)\n        return res;\n    }\n};\n\nvar forEach = function (xs, fn) {\n    if (xs.forEach) return xs.forEach(fn)\n    else for (var i = 0; i < xs.length; i++) {\n        fn(xs[i], i, xs);\n    }\n};\n\nvar defineProp = (function() {\n    try {\n        Object.defineProperty({}, '_', {});\n        return function(obj, name, value) {\n            Object.defineProperty(obj, name, {\n                writable: true,\n                enumerable: false,\n                configurable: true,\n                value: value\n            })\n        };\n    } catch(e) {\n        return function(obj, name, value) {\n            obj[name] = value;\n        };\n    }\n}());\n\nvar globals = ['Array', 'Boolean', 'Date', 'Error', 'EvalError', 'Function',\n'Infinity', 'JSON', 'Math', 'NaN', 'Number', 'Object', 'RangeError',\n'ReferenceError', 'RegExp', 'String', 'SyntaxError', 'TypeError', 'URIError',\n'decodeURI', 'decodeURIComponent', 'encodeURI', 'encodeURIComponent', 'escape',\n'eval', 'isFinite', 'isNaN', 'parseFloat', 'parseInt', 'undefined', 'unescape'];\n\nfunction Context() {}\nContext.prototype = {};\n\nvar Script = exports.Script = function NodeScript (code) {\n    if (!(this instanceof Script)) return new Script(code);\n    this.code = code;\n};\n\nScript.prototype.runInContext = function (context) {\n    if (!(context instanceof Context)) {\n        throw new TypeError(\"needs a 'context' argument.\");\n    }\n    \n    var iframe = document.createElement('iframe');\n    if (!iframe.style) iframe.style = {};\n    iframe.style.display = 'none';\n    \n    document.body.appendChild(iframe);\n    \n    var win = iframe.contentWindow;\n    var wEval = win.eval, wExecScript = win.execScript;\n\n    if (!wEval && wExecScript) {\n        // win.eval() magically appears when this is called in IE:\n        wExecScript.call(win, 'null');\n        wEval = win.eval;\n    }\n    \n    forEach(Object_keys(context), function (key) {\n        win[key] = context[key];\n    });\n    forEach(globals, function (key) {\n        if (context[key]) {\n            win[key] = context[key];\n        }\n    });\n    \n    var winKeys = Object_keys(win);\n\n    var res = wEval.call(win, this.code);\n    \n    forEach(Object_keys(win), function (key) {\n        // Avoid copying circular objects like `top` and `window` by only\n        // updating existing context properties or new properties in the `win`\n        // that was only introduced after the eval.\n        if (key in context || indexOf(winKeys, key) === -1) {\n            context[key] = win[key];\n        }\n    });\n\n    forEach(globals, function (key) {\n        if (!(key in context)) {\n            defineProp(context, key, win[key]);\n        }\n    });\n    \n    document.body.removeChild(iframe);\n    \n    return res;\n};\n\nScript.prototype.runInThisContext = function () {\n    return eval(this.code); // maybe...\n};\n\nScript.prototype.runInNewContext = function (context) {\n    var ctx = Script.createContext(context);\n    var res = this.runInContext(ctx);\n\n    if (context) {\n        forEach(Object_keys(ctx), function (key) {\n            context[key] = ctx[key];\n        });\n    }\n\n    return res;\n};\n\nforEach(Object_keys(Script.prototype), function (name) {\n    exports[name] = Script[name] = function (code) {\n        var s = Script(code);\n        return s[name].apply(s, [].slice.call(arguments, 1));\n    };\n});\n\nexports.isContext = function (context) {\n    return context instanceof Context;\n};\n\nexports.createScript = function (code) {\n    return exports.Script(code);\n};\n\nexports.createContext = Script.createContext = function (context) {\n    var copy = new Context();\n    if(typeof context === 'object') {\n        forEach(Object_keys(context), function (key) {\n            copy[key] = context[key];\n        });\n    }\n    return copy;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/main.ts\");\n",""],"names":[],"sourceRoot":""}