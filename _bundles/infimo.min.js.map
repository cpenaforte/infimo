{"version":3,"sources":["webpack://Infimo/webpack/universalModuleDefinition","webpack://Infimo/./src/main.ts","webpack://Infimo/./src/subclasses/NameRegister.ts","webpack://Infimo/./src/subclasses/Ref.ts","webpack://Infimo/./src/subclasses/VirtualMachine.ts","webpack://Infimo/./node_modules/vm-browserify/index.js","webpack://Infimo/webpack/bootstrap","webpack://Infimo/webpack/startup"],"names":["root","factory","exports","module","define","amd","self","appId","template","listeners","refs","namesRegister","constructor","infimoObject","this","data","watch","methods","notifyListeners","name","newValue","oldValue","forEach","listener","build","dataParse","value","registeredName","registerName","dataRef","push","Object","defineProperties","get","getValue","set","updateValue","dataProp","entries","watchParse","nameExist","Error","watchProp","methodsParse","method","refThis","methodRef","args","call","defineProperty","methodsProp","parseTemplate","intermediate","vm","initThis","replace","runScriptSync","match","parsedTemplate","step","document","createElement","element","innerHTML","firstElementChild","querySelector","appendChild","names","type","nameObj","registerNames","let","find","n","some","getNames","getName","context","thisObj","descriptors","getOwnPropertyDescriptors","parseDescriptors","map","key","console","log","fromEntries","script","result","Script","runInNewContext","e","error","indexOf","xs","item","i","length","Object_keys","obj","keys","res","fn","defineProp","writable","enumerable","configurable","globals","Context","prototype","code","runInContext","iframe","win","wEval","winKeys","style","display","body","contentWindow","eval","wExecScript","execScript","removeChild","TypeError","runInThisContext","ctx","createContext","s","apply","slice","arguments","isContext","createScript","copy","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","__webpack_exports__"],"mappings":"AAAA,UAA2CA,EAAMC,GAC1B,UAAnB,OAAOC,SAA0C,UAAlB,OAAOC,OACxCA,OAAOD,QAAUD,EAAQ,EACA,YAAlB,OAAOG,QAAyBA,OAAOC,IAC9CD,OAAO,SAAU,GAAIH,CAAO,EACF,UAAnB,OAAOC,QACdA,QAAgB,OAAID,EAAQ,EAE5BD,EAAa,OAAIC,EAAQ,CAC1B,EAAEK,KAAM,K;;;2LCRT,iFACA,yDACA,+EAuHA,gBApHYC,MACAC,SACAC,UACAC,KACAC,cAERC,YAAYC,GACRC,KAAKN,SAAWK,EAAaL,SAC7BM,KAAKL,UAAY,GACjBK,KAAKJ,KAAO,GACZI,KAAKH,cAAgB,IAAI,UAEzBG,KAAKC,KAAKF,EAAaE,MAAQ,EAAE,EACjCD,KAAKE,MAAMH,EAAaG,OAAS,EAAE,EACnCF,KAAKG,QAAQJ,EAAaI,SAAW,EAAE,CAC3C,CAEQC,gBAAmBC,EAAcC,EAAaC,GAC9CP,KAAKL,UAAUU,IACfL,KAAKL,UAAUU,GAAMG,QAAQC,GAAYA,EAASH,EAAUC,CAAQ,CAAC,EAGzEP,KAAKP,OAASO,KAAKU,MAAMV,KAAKP,KAAK,CACvC,CAEQkB,UAAaV,GACjB,KAAM,CAACI,EAAMO,GAASX,EAEhBY,EAAiBb,KAAKH,cAAciB,aAAaT,EAAM,MAAF,EAE3D,MAAMU,EAAU,IAAI,UAAIF,EAAgBD,CAAK,EAC7CZ,KAAKJ,KAAKoB,KAAKD,CAAO,EAEtBE,OAAOC,iBAAiBlB,KAAM,EACzBK,GAAO,CACJc,IAAK,IAAMJ,EAAQK,SAAS,EAC5BC,IAAK,IACD,IAAMd,EAAWQ,EAAQK,SAAS,EAClCL,EAAQO,YAAYhB,CAAQ,EAC5BN,KAAKI,gBAAgBC,EAAMC,EAAUC,CAAQ,CACjD,C,EAEP,CACL,CAEAN,KAAKsB,GACDN,OAAOO,QAAQD,CAAQ,EAAEf,QAAQP,GAAQD,KAAKW,UAAUV,CAAI,CAAC,CACjE,CAEQwB,WAAcvB,GAClB,GAAM,CAACG,EAAMO,GAASV,EAEtB,GAAI,CAACF,KAAKH,cAAc6B,UAAUrB,CAAI,EAClC,MAAM,IAAIsB,cAActB,kBAAqB,EAG5CL,KAAKL,UAAUU,KAChBL,KAAKL,UAAUU,GAAQ,IAG3BL,KAAKL,UAAUU,GAAMW,KAAKJ,CAAK,CACnC,CAEAV,MAAM0B,GACFX,OAAOO,QAAQI,CAAS,EAAEpB,QAAQN,GAASF,KAAKyB,WAAWvB,CAAK,CAAC,CACrE,CAEQ2B,aAAaC,GACjB,KAAM,CAACzB,EAAMO,GAASkB,EAEhBC,EAAU/B,KAIVa,EAAiBb,KAAKH,cAAciB,aAAaT,EAAM,SAAF,EAE3D,MAAM2B,EAAY,IAAI,UAAInB,EAJH,IAAIoB,IAAcrB,EAAMsB,KAAKH,EAAS,GAAGE,CAAI,CAIZ,EACxDjC,KAAKJ,KAAKoB,KAAKgB,CAAS,EAExBf,OAAOkB,eAAenC,KAAMK,EAAM,CAC9Bc,IAAK,IAAMa,EAAUZ,SAAS,C,CACjC,CACL,CAEAjB,QAAQiC,GACJnB,OAAOO,QAAQY,CAAW,EAAE5B,QAAQsB,GAAU9B,KAAK6B,aAAaC,CAAM,CAAC,CAC3E,CAEQO,gBACJ,IAAMC,EAAe,GAAGtC,KAAKN,SAE7B,MAAM6C,EAAK,IAAI,UAGf,OAFAA,EAAGC,SAASxC,IAAI,EAETsC,EAAaG,QAAQ,aAAc,IAGtC,MAAO,GAFYF,EAAGG,cAAcC,CAAK,CAG7C,CAAC,EAAEF,QAAQ,MAAO,EAAE,EAAEA,QAAQ,MAAO,EAAE,CAC3C,CAEA/B,MAAMjB,GACFO,KAAKP,MAAQA,EAEb,IAAMmD,EAAiB5C,KAAKqC,cAAc,EAEpCQ,EAAOC,SAASC,cAAc,KAAK,EAEnCC,GADNH,EAAKI,UAAYL,EACDC,EAAKK,mBAEjBF,GACAF,SAASK,cAAcnD,KAAKP,KAAK,GAAG2D,YAAYJ,CAAO,CAE/D,C;;;kHCrHJ,gBACYK,MAERvD,cACIE,KAAKqD,MAAQ,EACjB,CAEAvC,aAAaT,EAAciD,GAEvB,GAAItD,KAAK0B,UAAUrB,CAAI,EACnB,MAAM,IAAIsB,cAActB,kBAAqB,EAG3CkD,EAAU,CAAClD,OAAMiD,MAAI,EAI3B,OAFAtD,KAAKqD,MAAMrC,KAAKuC,CAAO,EAEhBA,CACX,CAEAC,cAAcH,GAEVI,IAAI/B,EAAY2B,EAAMK,KAAKC,GAAK3D,KAAK0B,UAAUiC,EAAEtD,IAAI,CAAC,GAAGA,KAEzD,GAAIqB,EACA,MAAM,IAAIC,cAAcD,kBAA0B,EAGtD1B,KAAKqD,MAAMrC,KAAK,GAAGqC,CAAK,CAC5B,CAEA3B,UAAUrB,GACN,OAAOL,KAAKqD,MAAMO,KAAKD,GAAKA,EAAEtD,OAASA,CAAI,CAC/C,CAEAwD,WACI,OAAO7D,KAAKqD,KAChB,C;;;yGCrCJ,gBACYhD,KACAO,MAERd,YAAYO,EAAsBO,GAC9BZ,KAAKK,KAAOA,EACZL,KAAKY,MAAQA,CACjB,CAEAU,YAAYV,GACRZ,KAAKY,MAAQA,CACjB,CAEAkD,UACI,OAAO9D,KAAKK,IAChB,CAEAe,WACI,OAAOpB,KAAKY,KAChB,C;;;gNCrBJ,+DAEA,gBACYmD,QAERjE,cACIE,KAAK+D,QAAU,EACnB,CAEAvB,SAASwB,GACCC,EAAchD,OAAOiD,0BAA0BF,CAAO,EACtDG,EAAmBlD,OAAOO,QAAQyC,CAAW,EAAEG,IAAI,EAAEC,EAAKzD,MACtDN,EAAWM,EAAMO,IAAMP,EAAMO,IAAI,EAAIP,EAAMA,MAEjD,OADA0D,QAAQC,IAAIjE,CAAQ,EACb,CAAC+D,EAAK/D,EACjB,CAAC,EAEDN,KAAK+D,QAAU9C,OAAOuD,YAAYL,CAAgB,CACtD,CAEAzB,cAAc+B,GACVhB,IAAIiB,EAAS,KAEb,IACIA,EAAS,IAAI,UAAGC,OAAOF,CAAM,EAAEG,gBAAgB5E,KAAK+D,OAAO,CAK/D,CAJE,MAAOc,GACLP,QAAQQ,MAAMD,CAAC,CACnB,C,QACI,OAAOH,CACX,CACJ,C;;;qFC9BJ,IAAIK,QAAU,SAAUC,EAAIC,GACxB,GAAID,EAAGD,QAAS,OAAOC,EAAGD,QAAQE,CAAI,EACjC,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAGG,OAAQD,CAAC,GACjC,GAAIF,EAAGE,KAAOD,EAAM,OAAOC,EAE/B,MAAO,CAAC,CACZ,EACIE,YAAc,SAAUC,GACxB,GAAIpE,OAAOqE,KAAM,OAAOrE,OAAOqE,KAAKD,CAAG,EAEnC,IACShB,EADLkB,EAAM,GACV,IAASlB,KAAOgB,EAAKE,EAAIvE,KAAKqD,CAAG,EACjC,OAAOkB,CAEf,EAEI/E,QAAU,SAAUwE,EAAIQ,GACxB,GAAIR,EAAGxE,QAAS,OAAOwE,EAAGxE,QAAQgF,CAAE,EAC/B,IAAK,IAAIN,EAAI,EAAGA,EAAIF,EAAGG,OAAQD,CAAC,GACjCM,EAAGR,EAAGE,GAAIA,EAAGF,CAAE,CAEvB,EAEIS,WAAc,WACd,IAEI,OADAxE,OAAOkB,eAAe,GAAI,IAAK,EAAE,EAC1B,SAASkD,EAAKhF,EAAMO,GACvBK,OAAOkB,eAAekD,EAAKhF,EAAM,CAC7BqF,SAAU,GACVC,WAAY,GACZC,aAAc,GACdhF,MAAOA,CACX,CAAC,CACL,CAKJ,CAJE,MAAMiE,GACJ,OAAO,SAASQ,EAAKhF,EAAMO,GACvByE,EAAIhF,GAAQO,CAChB,CACJ,CACJ,EAAG,EAECiF,QAAU,CAAC,QAAS,UAAW,OAAQ,QAAS,YAAa,WACjE,WAAY,OAAQ,OAAQ,MAAO,SAAU,SAAU,aACvD,iBAAkB,SAAU,SAAU,cAAe,YAAa,WAClE,YAAa,qBAAsB,YAAa,qBAAsB,SACtE,OAAQ,WAAY,QAAS,aAAc,WAAY,YAAa,YAEpE,SAASC,WACTA,QAAQC,UAAY,GAEpB,IAAIpB,OAASvF,QAAQuF,OAAS,SAAqBqB,GAC/C,GAAI,EAAEhG,gBAAgB2E,QAAS,OAAO,IAAIA,OAAOqB,CAAI,EACrDhG,KAAKgG,KAAOA,CAChB,EAEArB,OAAOoB,UAAUE,aAAe,SAAUlC,GACtC,IAIImC,EAMAC,EACAC,EAiBAC,EAEAd,EA9BJ,GAAMxB,aAAmB+B,QAiDzB,OA7CII,EAASpD,SAASC,cAAc,QAAQ,GAChCuD,QAAOJ,EAAOI,MAAQ,IAClCJ,EAAOI,MAAMC,QAAU,OAEvBzD,SAAS0D,KAAKpD,YAAY8C,CAAM,EAG5BE,GADAD,EAAMD,EAAOO,eACDC,KAAMC,EAAcR,EAAIS,WAEpC,CAACR,GAASO,IAEVA,EAAYzE,KAAKiE,EAAK,MAAM,EAC5BC,EAAQD,EAAIO,MAGhBlG,QAAQ4E,YAAYrB,CAAO,EAAG,SAAUM,GACpC8B,EAAI9B,GAAON,EAAQM,EACvB,CAAC,EACD7D,QAAQqF,QAAS,SAAUxB,GACnBN,EAAQM,KACR8B,EAAI9B,GAAON,EAAQM,GAE3B,CAAC,EAEGgC,EAAUjB,YAAYe,CAAG,EAEzBZ,EAAMa,EAAMlE,KAAKiE,EAAKnG,KAAKgG,IAAI,EAEnCxF,QAAQ4E,YAAYe,CAAG,EAAG,SAAU9B,IAI5BA,KAAON,GAAqC,CAAC,IAA3BgB,QAAQsB,EAAShC,CAAG,KACtCN,EAAQM,GAAO8B,EAAI9B,GAE3B,CAAC,EAED7D,QAAQqF,QAAS,SAAUxB,GACjBA,KAAON,GACT0B,WAAW1B,EAASM,EAAK8B,EAAI9B,EAAI,CAEzC,CAAC,EAEDvB,SAAS0D,KAAKK,YAAYX,CAAM,EAEzBX,EAhDH,MAAM,IAAIuB,UAAU,6BAA6B,CAiDzD,EAEAnC,OAAOoB,UAAUgB,iBAAmB,WAChC,OAAOL,KAAK1G,KAAKgG,IAAI,CACzB,EAEArB,OAAOoB,UAAUnB,gBAAkB,SAAUb,GACzC,IAAIiD,EAAMrC,OAAOsC,cAAclD,CAAO,EAClCwB,EAAMvF,KAAKiG,aAAae,CAAG,EAQ/B,OANIjD,GACAvD,QAAQ4E,YAAY4B,CAAG,EAAG,SAAU3C,GAChCN,EAAQM,GAAO2C,EAAI3C,EACvB,CAAC,EAGEkB,CACX,EAEA/E,QAAQ4E,YAAYT,OAAOoB,SAAS,EAAG,SAAU1F,GAC7CjB,QAAQiB,GAAQsE,OAAOtE,GAAQ,SAAU2F,GACrC,IAAIkB,EAAIvC,OAAOqB,CAAI,EACnB,OAAOkB,EAAE7G,GAAM8G,MAAMD,EAAG,GAAGE,MAAMlF,KAAKmF,UAAW,CAAC,CAAC,CACvD,CACJ,CAAC,EAEDjI,QAAQkI,UAAY,SAAUvD,GAC1B,OAAOA,aAAmB+B,OAC9B,EAEA1G,QAAQmI,aAAe,SAAUvB,GAC7B,OAAO5G,QAAQuF,OAAOqB,CAAI,CAC9B,EAEA5G,QAAQ6H,cAAgBtC,OAAOsC,cAAgB,SAAUlD,GACrD,IAAIyD,EAAO,IAAI1B,QAMf,MALsB,UAAnB,OAAO/B,GACNvD,QAAQ4E,YAAYrB,CAAO,EAAG,SAAUM,GACpCmD,EAAKnD,GAAON,EAAQM,EACxB,CAAC,EAEEmD,CACX,C,GCnJIC,yBAA2B,GAG/B,SAASC,oBAAoBC,GAE5B,IAAIC,EAAeH,yBAAyBE,GAC5C,OAAqBE,SAAjBD,IAIAvI,EAASoI,yBAAyBE,GAAY,CAGjDvI,QAAS,EACV,EAGA0I,oBAAoBH,GAAUzF,KAAK7C,EAAOD,QAASC,EAAQA,EAAOD,QAASsI,mBAAmB,GAGvFrI,EAAOD,OACf,CCnBA,IAAI2I,oBAAsBL,oBAAoB,eAAe,E","file":"infimo.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Infimo\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Infimo\"] = factory();\n\telse\n\t\troot[\"Infimo\"] = factory();\n})(self, () => {\nreturn ","import { DataProp, PropType, Listeners, InfimoObject } from \"./types\";\nimport NameRegister from \"./subclasses/NameRegister\";\nimport Ref from \"./subclasses/Ref\";\nimport VirtualMachine from \"./subclasses/VirtualMachine\";\n\nclass InfimoFactory {\n    private appId: string | undefined;\n    private template: string;\n    private listeners: Listeners;\n    private refs: Ref<any>[];\n    private namesRegister: NameRegister;\n\n    constructor(infimoObject: InfimoObject) {\n        this.template = infimoObject.template;\n        this.listeners = {};\n        this.refs = [];\n        this.namesRegister = new NameRegister();\n\n        this.data(infimoObject.data || {});\n        this.watch(infimoObject.watch || {});\n        this.methods(infimoObject.methods || {});\n    }\n\n    private notifyListeners<T>(name: string, newValue: T, oldValue: T): void {\n        if (this.listeners[name]) {\n            this.listeners[name].forEach(listener => listener(newValue, oldValue));\n        }\n\n        this.appId && this.build(this.appId);\n    }\n\n    private dataParse<T>(data: [string, T]): void {\n        const [name, value] = data;\n\n        const registeredName = this.namesRegister.registerName(name, PropType.DATA);\n\n        const dataRef = new Ref(registeredName, value);\n        this.refs.push(dataRef);\n\n        Object.defineProperties(this, {\n            [name]: {\n                get: () => dataRef.getValue(),\n                set: (newValue: T) => {\n                    const oldValue = dataRef.getValue();\n                    dataRef.updateValue(newValue);\n                    this.notifyListeners(name, newValue, oldValue);\n                }\n            }\n        });\n    }\n\n    data(dataProp: DataProp): void {\n        Object.entries(dataProp).forEach(data => this.dataParse(data));\n    }\n\n    private watchParse<T>(watch: [string, (newValue?: T, oldValue?: T) => void]): void {\n        const [name, value] = watch;\n\n        if (!this.namesRegister.nameExist(name)) {\n            throw new Error(`Name ${name} does not exist`);\n        }\n\n        if (!this.listeners[name]) {\n            this.listeners[name] = [];\n        }\n\n        this.listeners[name].push(value);\n    }\n\n    watch(watchProp: { [key: string]: (newValue?: any, oldValue?: any) => void }): void {\n        Object.entries(watchProp).forEach(watch => this.watchParse(watch));\n    }\n\n    private methodsParse(method: [string, Function]): void {\n        const [name, value] = method;\n\n        const refThis = this;\n\n        const parsedFunction = (...args: any) => value.call(refThis, ...args);\n\n        const registeredName = this.namesRegister.registerName(name, PropType.METHODS);\n\n        const methodRef = new Ref(registeredName, parsedFunction);\n        this.refs.push(methodRef);\n\n        Object.defineProperty(this, name, {\n            get: () => methodRef.getValue()\n        });\n    }\n\n    methods(methodsProp: { [key: string]: Function }): void {\n        Object.entries(methodsProp).forEach(method => this.methodsParse(method));\n    }\n\n    private parseTemplate(): string {\n        const intermediate = `${this.template}`;\n\n        const vm = new VirtualMachine();\n        vm.initThis(this);\n\n        return intermediate.replace(/{{(.*?)}}/g, (match) => {\n            const evalutated = vm.runScriptSync(match);\n\n            return `${evalutated}`;\n        }).replace(/{{/g, \"\").replace(/}}/g, \"\");\n    }\n\n    build(appId: string): void {\n        this.appId = appId;\n\n        const parsedTemplate = this.parseTemplate();\n\n        const step = document.createElement(\"div\");\n        step.innerHTML = parsedTemplate;\n        const element = step.firstElementChild;\n\n        if (element) {\n            document.querySelector(this.appId)?.appendChild(element);\n        }\n    }\n}\n\nexport default InfimoFactory;","import { PropType, RegisteredName, RegisteredNames } from \"../types\";\n\nexport default class NameRegister {\n    private names: RegisteredNames;\n\n    constructor() {\n        this.names = [];\n    }\n\n    registerName(name: string, type: PropType): RegisteredName {\n        // Check if name already exists\n        if (this.nameExist(name)) {\n            throw new Error(`Name ${name} already exists`);\n        }\n\n        const nameObj = {name, type};\n\n        this.names.push(nameObj);\n\n        return nameObj;\n    }\n\n    registerNames(names: RegisteredNames): void {\n        // Check if names already exist\n        let nameExist = names.find(n => this.nameExist(n.name))?.name;\n\n        if (nameExist) {\n            throw new Error(`Name ${nameExist} already exists`);\n        }\n\n        this.names.push(...names);\n    }\n\n    nameExist(name: string): boolean {\n        return this.names.some(n => n.name === name);\n    }\n\n    getNames(): RegisteredNames {\n        return this.names;\n    }\n}","import { RegisteredName } from \"../types\";\n\nexport default class Ref<T> {\n    private name: RegisteredName;\n    private value: T;\n\n    constructor(name: RegisteredName, value: T) {\n        this.name = name;\n        this.value = value;\n    }\n\n    updateValue(value: T): void {\n        this.value = value;\n    }\n\n    getName(): RegisteredName {\n        return this.name;\n    }\n\n    getValue(): T {\n        return this.value;\n    }\n}","import vm from \"vm\";\n\nexport default class VirtualMachine {\n    private context: { [key: string]: any };\n\n    constructor() {\n        this.context = {};\n    }\n\n    initThis(thisObj: { [key: string]: any }): void {\n        const descriptors = Object.getOwnPropertyDescriptors(thisObj);\n        const parseDescriptors = Object.entries(descriptors).map(([key, value]) => {\n            const newValue = value.get ? value.get() : value.value;\n            console.log(newValue);\n            return [key, newValue];\n        });\n\n        this.context = Object.fromEntries(parseDescriptors);\n    }\n\n    runScriptSync(script: string): any {\n        let result = null;\n\n        try {\n            result = new vm.Script(script).runInNewContext(this.context);\n        } catch (e) {\n            console.error(e);\n        } finally {\n            return result;\n        }\n    }\n}","var indexOf = function (xs, item) {\n    if (xs.indexOf) return xs.indexOf(item);\n    else for (var i = 0; i < xs.length; i++) {\n        if (xs[i] === item) return i;\n    }\n    return -1;\n};\nvar Object_keys = function (obj) {\n    if (Object.keys) return Object.keys(obj)\n    else {\n        var res = [];\n        for (var key in obj) res.push(key)\n        return res;\n    }\n};\n\nvar forEach = function (xs, fn) {\n    if (xs.forEach) return xs.forEach(fn)\n    else for (var i = 0; i < xs.length; i++) {\n        fn(xs[i], i, xs);\n    }\n};\n\nvar defineProp = (function() {\n    try {\n        Object.defineProperty({}, '_', {});\n        return function(obj, name, value) {\n            Object.defineProperty(obj, name, {\n                writable: true,\n                enumerable: false,\n                configurable: true,\n                value: value\n            })\n        };\n    } catch(e) {\n        return function(obj, name, value) {\n            obj[name] = value;\n        };\n    }\n}());\n\nvar globals = ['Array', 'Boolean', 'Date', 'Error', 'EvalError', 'Function',\n'Infinity', 'JSON', 'Math', 'NaN', 'Number', 'Object', 'RangeError',\n'ReferenceError', 'RegExp', 'String', 'SyntaxError', 'TypeError', 'URIError',\n'decodeURI', 'decodeURIComponent', 'encodeURI', 'encodeURIComponent', 'escape',\n'eval', 'isFinite', 'isNaN', 'parseFloat', 'parseInt', 'undefined', 'unescape'];\n\nfunction Context() {}\nContext.prototype = {};\n\nvar Script = exports.Script = function NodeScript (code) {\n    if (!(this instanceof Script)) return new Script(code);\n    this.code = code;\n};\n\nScript.prototype.runInContext = function (context) {\n    if (!(context instanceof Context)) {\n        throw new TypeError(\"needs a 'context' argument.\");\n    }\n    \n    var iframe = document.createElement('iframe');\n    if (!iframe.style) iframe.style = {};\n    iframe.style.display = 'none';\n    \n    document.body.appendChild(iframe);\n    \n    var win = iframe.contentWindow;\n    var wEval = win.eval, wExecScript = win.execScript;\n\n    if (!wEval && wExecScript) {\n        // win.eval() magically appears when this is called in IE:\n        wExecScript.call(win, 'null');\n        wEval = win.eval;\n    }\n    \n    forEach(Object_keys(context), function (key) {\n        win[key] = context[key];\n    });\n    forEach(globals, function (key) {\n        if (context[key]) {\n            win[key] = context[key];\n        }\n    });\n    \n    var winKeys = Object_keys(win);\n\n    var res = wEval.call(win, this.code);\n    \n    forEach(Object_keys(win), function (key) {\n        // Avoid copying circular objects like `top` and `window` by only\n        // updating existing context properties or new properties in the `win`\n        // that was only introduced after the eval.\n        if (key in context || indexOf(winKeys, key) === -1) {\n            context[key] = win[key];\n        }\n    });\n\n    forEach(globals, function (key) {\n        if (!(key in context)) {\n            defineProp(context, key, win[key]);\n        }\n    });\n    \n    document.body.removeChild(iframe);\n    \n    return res;\n};\n\nScript.prototype.runInThisContext = function () {\n    return eval(this.code); // maybe...\n};\n\nScript.prototype.runInNewContext = function (context) {\n    var ctx = Script.createContext(context);\n    var res = this.runInContext(ctx);\n\n    if (context) {\n        forEach(Object_keys(ctx), function (key) {\n            context[key] = ctx[key];\n        });\n    }\n\n    return res;\n};\n\nforEach(Object_keys(Script.prototype), function (name) {\n    exports[name] = Script[name] = function (code) {\n        var s = Script(code);\n        return s[name].apply(s, [].slice.call(arguments, 1));\n    };\n});\n\nexports.isContext = function (context) {\n    return context instanceof Context;\n};\n\nexports.createScript = function (code) {\n    return exports.Script(code);\n};\n\nexports.createContext = Script.createContext = function (context) {\n    var copy = new Context();\n    if(typeof context === 'object') {\n        forEach(Object_keys(context), function (key) {\n            copy[key] = context[key];\n        });\n    }\n    return copy;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/main.ts\");\n"],"sourceRoot":""}